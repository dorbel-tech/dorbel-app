 files:
  "/etc/yum.repos.d/logentries.repo" :
    mode: "000664"
    owner: root
    group: root
    content: |
      [logentries]
      name=Logentries repo
      enabled=1
      metadata_expire=1d
      baseurl=http://rep.logentries.com/amazonlatest/\$basearch
      gpgkey=http://rep.logentries.com/RPM-GPG-KEY-logentries
    encoding: plain

  "/etc/le/config" :
    mode: "000755"
    owner: root
    group: root
    content: |
      [Main]
      user-key = "c9fdfa35-a62a-4b2d-83ed-403e7a6d764d"
      pull-server-side-config=False
      v1_metrics = False
      metrics-mem = system
      metrics-token = 
      metrics-disk = sum
      metrics-swap = system
      metrics-space = /
      metrics-vcpu = core
      metrics-net = sum
      metrics-interval = 5s
      metrics-cpu = system
                 
      [elasticbeanstalk]
      path = /var/log/
      token = "c54f4c74-2d4b-4bba-8e99-3a7f084d69a3"
      
      [elasticbeanstalk]
      path = /var/log/
      destination = MyLogset/MyLog
    encoding: plain

commands:
  01_update_yum:
    command: yum update 
  02_install_logentries:
    command: yum install python-setuptools -y
  02a_install_logentries:
    command: yum install logentries -y
  02b_install_logentries:
    command: yum install logentries-daemon -y
  03_restart_logentries:
    command: service logentries start
